(this["webpackJsonprealtime-chat-app"]=this["webpackJsonprealtime-chat-app"]||[]).push([[0],{50:function(e,t,a){},51:function(e,t,a){},53:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var c=a(2),n=a(3),s=a.n(n),r=a(28),i=a.n(r),o=(a(50),a(51),a(18)),l=a(9),u=a(5),j=a(8),d=a.n(j),b=a(14),O=a(20),h=(a(53),a(11)),p=a(35);a(58),a(70);p.a.initializeApp({apiKey:"AIzaSyDhWHYUo31EhafDtO8OdAlDZthmVN85TPI",authDomain:"realtime-chat-ap.firebaseapp.com",projectId:"realtime-chat-ap",storageBucket:"realtime-chat-ap.appspot.com",messagingSenderId:"930254441751",appId:"1:930254441751:web:c256a9a83d26e7af4d7b52",measurementId:"G-8Q95J2GC5R"});var m=p.a,f="USER_LOGIN",x="USER_LOGOUT",v="GET_REALTIME_USERS",N="UPDATE_MESSAGE",S="GET_REALTIME_MESSAGE",g="SET_SEEN_MESSAGE",y="GET_LOADMORE_MESSAGE",E=function(e){return function(){var t=Object(b.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=m.firestore(),a({type:"".concat(f,"_REQUEST")}),m.auth().createUserWithEmailAndPassword(e.email,e.password).then((function(t){var n=m.auth().currentUser,s="".concat(e.firstName," ").concat(e.lastName);n.updateProfile({displayName:s}).then((function(){c.collection("users").doc(t.user.uid).set({firstName:e.firstName,lastName:e.lastName,createdAt:new Date,uid:t.user.uid,isOnline:!0}).then((function(){var c={firstName:e.firstName,lastName:e.lastName,uid:t.user.uid,email:e.email};localStorage.setItem("user",JSON.stringify({loggedUser:c})),a({type:"".concat(f,"_SUCCESS"),payload:{user:c}})})).catch((function(e){a({type:"".concat(f,"_FAILURE"),payload:e})}))}))})).catch((function(e){a({type:"".concat(f,"_FAILURE"),payload:{error:e.message}})}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};function _(){var e=Object(h.c)((function(e){return e.auth})),t=Object(h.b)();return Object(c.jsx)("div",{className:"header",children:Object(c.jsxs)("div",{className:"navBar",children:[Object(c.jsx)("div",{className:"navSide",children:Object(c.jsxs)("ul",{className:"navWrap",children:[Object(c.jsx)("li",{className:"navItem",children:Object(c.jsx)(o.c,{to:"/",className:"navLink",children:"HOME"})}),Object(c.jsx)("li",{className:"navItem",children:Object(c.jsx)(o.c,{to:"/about",className:"navLink",children:"ABOUT"})})]})}),Object(c.jsx)("div",{className:"logoArea",children:Object(c.jsx)("img",{src:"https://www.williamdollace.it/wp-content/themes/williamdollacetheme/images/logo.svg"})}),Object(c.jsx)("div",{className:"navSide",children:e.authenticated?Object(c.jsxs)("ul",{className:"navWrap",children:[Object(c.jsx)("li",{className:"navItem",children:Object(c.jsxs)(o.c,{to:"/profile",className:"navLink",children:[e.firstName," PROFILE"]})}),Object(c.jsx)("li",{className:"navItem",children:Object(c.jsx)(o.b,{to:"#",onClick:function(){var a;t((a=e.uid,function(){var e=Object(b.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"".concat(x,"_REQUEST")}),m.firestore().collection("users").doc(a).update({isOnline:!1}).then((function(){m.auth().signOut().then((function(){localStorage.clear(),t({type:"".concat(x,"_SUCCESS")})})).catch((function(e){t({type:"".concat(x,"_FAILURE"),payload:{error:e}})}))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},className:"navLink",children:"LOG OUT"})})]}):Object(c.jsxs)("ul",{className:"navWrap",children:[Object(c.jsx)("li",{className:"navItem",children:Object(c.jsx)(o.c,{to:"/login",className:"navLink",children:"LOGIN"})}),Object(c.jsx)("li",{className:"navItem",children:Object(c.jsx)(o.c,{to:"/signup",className:"navLink",children:"SIGN UP"})})]})})]})})}function w(e){return Object(c.jsxs)("div",{className:"layout",children:[Object(c.jsx)(_,{}),e.children]})}a(62);function U(e){var t=e.value,a=e.type,s=e.label,r=e.onChange,i=e.placeholder,o=Object(n.useState)("inputGroup"),l=Object(O.a)(o,2),u=l[0],j=l[1];return Object(c.jsxs)("div",{className:u,children:[Object(c.jsx)("label",{children:s}),Object(c.jsx)("input",{type:a,onFocus:function(e){j("inputGroup onFocus")},onChange:function(e){var t=e.target.value;r(t)},placeholder:i,value:t}),Object(c.jsx)("div",{className:"line"})]})}a(63);function C(e){return Object(c.jsx)("div",{className:"card",children:e.children})}a(64);function I(e){return Object(c.jsx)("button",{type:e.type,className:"buttonGold",children:e.children})}a(65);function A(e){return Object(c.jsx)("div",{className:"title",children:Object(c.jsx)("p",{children:e.children})})}a(66);var L=a(31),R=function(e){return Object(c.jsxs)("div",{className:"error",children:[Object(c.jsx)("p",{children:e.children}),Object(c.jsx)(L.a,{className:"icon"})]})};function T(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e.auth})),a=Object(n.useState)({email:"",password:"",firstName:"",lastName:""}),s=Object(O.a)(a,2),r=s[0],i=s[1],o=function(){var t=Object(b.a)(d.a.mark((function t(a){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.preventDefault(),e(E(r));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return!0===t.authenticated?Object(c.jsx)(l.a,{to:"/"}):Object(c.jsx)(w,{children:Object(c.jsx)(C,{children:Object(c.jsxs)("form",{onSubmit:o,className:"authForm",children:[Object(c.jsx)(A,{children:"SIGN UP"}),Object(c.jsx)(U,{type:"text",label:"First name",placeholder:"",onChange:function(e){return i(Object(u.a)(Object(u.a)({},r),{},{firstName:e}))}}),Object(c.jsx)(U,{type:"text",label:"Last name",placeholder:"",onChange:function(e){return i(Object(u.a)(Object(u.a)({},r),{},{lastName:e}))}}),Object(c.jsx)(U,{type:"text",label:"Email",placeholder:"",onChange:function(e){return i(Object(u.a)(Object(u.a)({},r),{},{email:e}))}}),Object(c.jsx)(U,{type:"password",label:"Password",placeholder:"",onChange:function(e){return i(Object(u.a)(Object(u.a)({},r),{},{password:e}))}}),t.error?Object(c.jsx)(R,{children:t.error}):Object(c.jsx)(c.Fragment,{}),Object(c.jsx)(I,{type:"submit",children:"SIGN UP"})]})})})}a(67);var k=function(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e.auth})),a=Object(n.useState)({email:"",password:""}),s=Object(O.a)(a,2),r=s[0],i=s[1];return!0===t.authenticated?Object(c.jsx)(l.a,{to:"/"}):Object(c.jsx)(w,{children:Object(c.jsx)(C,{children:Object(c.jsxs)("form",{onSubmit:function(t){var a;t.preventDefault(),e((a=r,function(){var e=Object(b.a)(d.a.mark((function e(t){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"".concat(f,"_REQUEST")}),c=m.firestore(),m.auth().signInWithEmailAndPassword(a.email,a.password).then((function(e){c.collection("users").doc(e.user.uid).update({isOnline:!0}).then((function(){var a=e.user.displayName;a=a.split(" ");for(var c=new Array,n=0;n<a.length;n++)c.push(a[n]);var s={firstName:a[0],lastName:a[1],uid:e.user.uid,email:e.user.email};localStorage.setItem("user",JSON.stringify({user:s})),t({type:"".concat(f,"_SUCCESS"),payload:{user:s}})}))})).catch((function(e){t({type:"".concat(f,"_FAILURE"),payload:{error:e.message}})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))},className:"authForm",children:[Object(c.jsx)(A,{children:"Login"}),Object(c.jsx)(U,{type:"email",label:"Email",placeholder:"",onChange:function(e){return i(Object(u.a)(Object(u.a)({},r),{},{email:e}))}}),Object(c.jsx)(U,{type:"password",label:"Password",placeholder:"",onChange:function(e){return i(Object(u.a)(Object(u.a)({},r),{},{password:e}))}}),t.error?Object(c.jsx)(R,{children:t.error}):Object(c.jsx)(c.Fragment,{}),Object(c.jsx)(I,{type:"submit",children:"LOG IN"})]})})})},G=a.p+"static/media/mint.98ef681e.jpg",D=(a(68),a(21)),F=a(38),Q=a(41),P=a(39),B=function(){var e=Object(n.useState)(""),t=Object(O.a)(e,2),a=t[0],s=t[1],r=Object(n.useState)(""),i=Object(O.a)(r,2),o=i[0],l=i[1],j=Object(n.useState)(""),p=Object(O.a)(j,2),f=p[0],x=p[1],y=Object(h.b)(),E=Object(h.c)((function(e){return e.user})),_=E.users,U=E.conversations,C=E.loadingUser,R=E.loadingChat,T=Object(h.c)((function(e){return e.auth})),k=function(){var e;y((e=T.uid,function(){var t=Object(b.a)(d.a.mark((function t(a){var c,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"".concat(v,"_REQUEST")}),c=m.firestore(),n=c.collection("users").where("uid","!=",e).onSnapshot((function(e){var t=[];e.forEach((function(e){e.data().length!=t.length&&t.push(e.data())})),a({type:"".concat(v,"_SUCCESS"),payload:{users:t}})})),t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))};Object(n.useEffect)((function(){k()}),[]);var B=function(e){var t={uid_1:T.uid,uid_2:e.uid};y(function(e){var t=e.uid_1,a=e.uid_2;return function(){var e=Object(b.a)(d.a.mark((function e(c){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c({type:"".concat(S,"_REQUEST")}),m.firestore().collection("conversations").orderBy("createdAt","asc").where("user_uid_1","in",[a,t]).onSnapshot((function(e){var n=[];e.forEach((function(e){(e.data().user_uid_1==t&&e.data().user_uid_2==a||e.data().user_uid_1==a&&e.data().user_uid_2==t)&&n.push(e.data())})),c({type:"".concat(S,"_SUCCESS"),payload:{conversations:n}})}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(t)),l(e)},M=function(e){e.preventDefault();var t={user_uid_1:T.uid,user_uid_2:o.uid,message:f};""!==f&&(y(function(e){return function(){var t=Object(b.a)(d.a.mark((function t(a){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"".concat(N,"_REQUEST")}),m.firestore().collection("conversations").add(Object(u.a)(Object(u.a)({},e),{},{isView:!1,createdAt:new Date})).then((function(e){a({type:"".concat(N,"_SUCCESS")})})).catch((function(e){a({type:"".concat(N,"_REQUEST"),payload:{error:e.message}})}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)),x(""))},W=function(e){y(function(e){var t=e.uid_1,a=e.uid_2;return function(){var e=Object(b.a)(d.a.mark((function e(c){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c({type:"".concat(g,"_REQUEST")}),m.firestore().collection("conversations").where("user_uid_1","==",a).where("user_uid_2","==",t).orderBy("createdAt","desc").onSnapshot((function(e){e.forEach((function(e){e.ref.update({isView:!0})}))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({uid_1:T.uid,uid_2:o.uid}))};return Object(c.jsx)(w,{children:Object(c.jsxs)("div",{className:"homePage",children:[C?Object(c.jsx)("div",{className:"friendList loading",children:Object(c.jsx)(F.a,{className:"icon"})}):Object(c.jsx)("div",{className:"friendList",children:_.map((function(e,t){return Object(c.jsxs)("div",{onClick:function(){B(e),function(e){""!==a?(document.querySelectorAll(".friend")[a].classList.remove("isSelected"),document.querySelectorAll(".friend")[e].classList.add("isSelected"),s(e)):(document.querySelectorAll(".friend")[e].classList.add("isSelected"),s(e))}(t)},className:"friend",children:[Object(c.jsxs)("div",{className:"avatar",children:[Object(c.jsx)("img",{src:G,alt:"avatar"}),Object(c.jsx)("span",{className:e.isOnline?"isOnline":"isOffline"})]}),Object(c.jsxs)("div",{className:"friendState",children:[Object(c.jsx)("p",{className:"friendName",children:e.firstName+e.lastName}),Object(c.jsxs)("div",{className:"friendLastText",children:[Object(c.jsx)("p",{className:"lastText",children:"See you again "}),Object(c.jsx)("span",{}),Object(c.jsx)("p",{children:"4 hours ago"})]})]}),Object(c.jsx)("div",{className:"friendButton",children:Object(c.jsxs)("button",{children:[Object(c.jsx)("div",{className:"circle"}),Object(c.jsx)("div",{className:"circle"}),Object(c.jsx)("div",{className:"circle"})]})})]},t)}))}),""!==o?Object(c.jsxs)("div",{className:"chatBox",children:[Object(c.jsxs)("div",{className:"headBox",children:[Object(c.jsxs)("div",{className:"headUser",children:[Object(c.jsx)("img",{alt:"avatar",src:G}),Object(c.jsx)("p",{children:o.firstName})]}),Object(c.jsxs)("div",{className:"headCall",children:[Object(c.jsx)(D.e,{className:"icon"}),Object(c.jsx)(Q.a,{className:"icon"}),Object(c.jsx)(D.d,{className:"icon"})]})]}),R?Object(c.jsx)("div",{className:"chatArea loading",children:Object(c.jsx)(F.a,{className:"icon"})}):Object(c.jsx)("div",{className:"chatArea",children:Object(c.jsx)("div",{className:"chatAreaWrap",children:U.map((function(e,t){return Object(c.jsxs)("div",{className:T.uid==e.user_uid_1?"chatWrapper right":"chatWrapper left",children:[T.uid!==e.user_uid_1?Object(c.jsx)("img",{src:G}):Object(c.jsx)(c.Fragment,{}),Object(c.jsx)("p",{children:e.message},t),Object(c.jsx)(D.a,{className:T.uid!=e.user_uid_1||e.isView?"icon gone":"icon"})]})}))})}),Object(c.jsxs)("div",{className:"typeArea",children:[Object(c.jsxs)("div",{className:"action",children:[Object(c.jsx)(D.g,{className:"icon"}),Object(c.jsx)(D.f,{className:"icon"}),Object(c.jsx)(P.a,{className:"icon"}),Object(c.jsx)(D.b,{className:"icon"})]}),Object(c.jsxs)("div",{className:"input",children:[Object(c.jsx)("form",{onSubmit:M,children:Object(c.jsx)("input",{value:f,onClick:function(){return W()},onChange:function(e){return x(e.target.value)},type:"text",placeholder:"Aa"})}),Object(c.jsx)(P.a,{className:"icon"})]}),Object(c.jsx)("div",{className:"likeButton",children:""===f?Object(c.jsx)(D.c,{className:"icon"}):Object(c.jsx)(D.h,{onClick:M,className:"icon"})})]})]}):Object(c.jsxs)("div",{className:"chatBox unSelected",children:[Object(c.jsx)(L.b,{className:"bigIcon"}),Object(c.jsx)(A,{children:"Your Message"}),Object(c.jsx)("p",{children:"Send private photos and messages to a friend or group."}),Object(c.jsx)(I,{children:"Send a message"})]})]})})},M=a(44);function W(e){var t=e.component,a=Object(M.a)(e,["component"]);return Object(c.jsx)(l.b,Object(u.a)(Object(u.a)({},a),{},{component:function(e){return(localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null)?Object(c.jsx)(t,Object(u.a)({},e)):Object(c.jsx)(l.a,{to:"/login"})}}))}var J=function(){var e=Object(h.b)(),t=Object(h.c)((function(e){return e.auth}));s.a.useEffect((function(){t.authenticated||e(function(){var e=Object(b.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null,t(a?{type:"".concat(f,"_SUCCESS"),payload:{user:a.user}}:{type:"".concat(f,"_FAILURE"),payload:{error:""}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var a=[{path:"/",name:"Home",component:B},{path:"/login",name:"Login",component:k},{path:"/signup",name:"Sign Up",component:T}];return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(o.a,{children:a.map((function(e){return Object(c.jsx)("div",{children:"Home"===e.name?Object(c.jsx)(W,{path:e.path,component:e.component,exact:!0}):Object(c.jsx)(l.b,{path:e.path,component:e.component})},e.name)}))})})},H=a(22),V={firstName:"",lastName:"",uid:"",email:"",authenticating:!1,authenticated:!1,error:null},q=a(43),z={users:[],conversations:[],loadingUser:!0,loadingChat:!0,lastestDoc:{}},Y=Object(H.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"".concat(f,"_REQUEST"):return e=Object(u.a)(Object(u.a)({},e),{},{authenticating:!0});case"".concat(f,"_SUCCESS"):return e=Object(u.a)(Object(u.a)({},e),{},{firstName:t.payload.user.firstName,lastName:t.payload.user.lastName,uid:t.payload.user.uid,email:t.payload.user.email,authenticated:!0,authenticating:!1,error:null});case"".concat(f,"_FAILURE"):return e=Object(u.a)(Object(u.a)({},e),{},{authenticated:!1,authenticating:!1,error:t.payload.error});case"".concat(x,"_REQUEST"):return e;case"".concat(x,"_SUCCESS"):return e=Object(u.a)({},V);case"".concat(x,"_FAILURE"):return e=Object(u.a)(Object(u.a)({},e),{},{error:t.payload.error});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"".concat(v,"_REQUEST"):return e=Object(u.a)(Object(u.a)({},e),{},{loadingUser:!0});case"".concat(v,"_SUCCESS"):return e=Object(u.a)(Object(u.a)({},e),{},{loadingUser:!1,users:t.payload.users});case"".concat(S,"_REQUEST"):return e=Object(u.a)(Object(u.a)({},e),{},{loadingChat:!0});case"".concat(S,"_SUCCESS"):return e=Object(u.a)(Object(u.a)({},e),{},{loadingChat:!1,conversations:t.payload.conversations,lastestDoc:t.payload.lastestDoc});case"".concat(y,"_REQUEST"):return e=Object(u.a)(Object(u.a)({},e),{},{loadingChat:!0});case"".concat(y,"_SUCCESS"):return e=Object(u.a)(Object(u.a)({},e),{},{loadingChat:!1,conversations:[t.payload.conversations].concat(Object(q.a)(e.conversations)),lastestDoc:t.payload.lastestDoc});default:return e}}}),K=a(42),Z=Object(H.d)(Y,Object(H.a)(K.a));window.store=Z,i.a.render(Object(c.jsx)(h.a,{store:Z,children:Object(c.jsx)(J,{})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.dd4cec97.chunk.js.map